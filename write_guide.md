# main Docusaurus 문서 작성 가이드

## 프로젝트 개요

이 프로젝트는 AI플랫폼 개발본부 기술 문서 사이트입니다. 현재 두 개의 독립적인 문서 사이트가 구성되어 있습니다:

- **dsbp-jwt**: DSBP JWT 라이브러리 기술 문서
- **main**: Vue Starter 기술 문서

## 프로젝트 구조

```
main/           # Vue Starter 문서
  ├── docs/              # 문서 작성 위치
  ├── static/            # 이미지 파일 위치
  ├── src/               # 커스텀 컴포넌트 및 스타일
  ├── docusaurus.config.ts  # 사이트 설정
  └── sidebars.ts        # 사이드바 구조 설정
```

## 시작하기

### 개발 서버 실행

```bash
# 최초
npm install

npm start
```

## 문서 작성 방법

### 문서 파일 위치

모든 문서는 `main/docs/` 디렉토리에 Markdown(`.md`) 형식으로 작성합니다.

```
main/docs/
├── intro.md                    # 소개 페이지
├── tutorial-basics/            # 기본 튜토리얼 폴더
│   ├── create-a-document.md
│   ├── create-a-page.md
│   └── ...
└── tutorial-extras/            # 추가 튜토리얼 폴더
    ├── manage-docs-versions.md
    └── translate-your-site.md
```

### 문서 파일 작성 형식

각 문서 파일은 Front Matter와 본문으로 구성됩니다.

#### Front Matter (문서 메타데이터)

파일 상단에 `---`로 구분된 YAML 형식의 메타데이터를 작성합니다:

```markdown
---
sidebar_position: 1
sidebar_label: 소개
---

# 문서 제목

문서 내용...
```

**주요 Front Matter 옵션:**

- `sidebar_position`: 사이드바에서의 순서 (숫자가 작을수록 위에 표시)
- `sidebar_label`: 사이드바에 표시될 이름
- `title`: 문서 제목 (생략 시 첫 번째 # 제목 사용)
- `description`: 문서 설명 (SEO용)

#### 본문 작성

Markdown 문법을 사용하여 문서를 작성합니다:

```markdown
# 제목 1

## 제목 2

### 제목 3

일반 텍스트입니다. **굵은 글씨**, _기울임_, `코드`

- 목록 항목 1
- 목록 항목 2

1. 번호 목록 1
2. 번호 목록 2

[링크 텍스트](URL)
```

### 이미지 추가하기

#### 1. 이미지 파일 저장

이미지는 `main/static/img/` 디렉토리에 저장합니다:

```
main/static/img/
├── logo.svg
├── favicon.ico
└── my-screenshot.png  # 여기에 이미지 추가
```

#### 2. 문서에서 이미지 참조

```markdown
<div style={{textAlign: 'center'}}>
    <img 
        src="/main/img/img.png"
        alt="image"
        style={{ width: '100%', maxWidth: '1000px', borderRadius: '8px' }}
    />
</div>
```

### 사이드바 구조 설정

#### 자동 생성 방식 (현재 설정)

`main/sidebars.ts` 파일에서 자동 생성 방식을 사용하고 있습니다:

```typescript
const sidebars: SidebarsConfig = {
  tutorialSidebar: [{ type: "autogenerated", dirName: "." }],
};
```

이 방식은 `docs/` 폴더 구조를 기반으로 자동으로 사이드바를 생성합니다.

- 폴더는 카테고리로 표시됩니다
- 파일의 `sidebar_position`으로 순서가 결정됩니다
- 파일의 `sidebar_label` 또는 첫 번째 제목이 사이드바 이름으로 사용됩니다

#### 수동 설정 방식

더 세밀한 제어가 필요한 경우 수동으로 사이드바를 구성할 수 있습니다

```typescript
const sidebars: SidebarsConfig = {
  tutorialSidebar: [
    "intro", // intro.md 파일
    {
      type: "category",
      label: "시작하기",
      items: ["getstarted/installation", "getstarted/configuration"],
    },
    {
      type: "category",
      label: "개발 가이드",
      items: ["developguide/basic", "developguide/advanced"],
    },
  ],
};
```

### 카테고리 설정 (_category_.json)

각 폴더(카테고리)에 `_category_.json` 파일을 추가하여 카테고리의 메타데이터를 설정할 수 있습니다.

#### _category_.json 파일 위치

```
main/docs/
├── intro.md
├── getstarted/
│   ├── _category_.json        # 이 폴더의 카테고리 설정
│   ├── installation.md
│   └── configuration.md
└── developguide/
    ├── _category_.json        # 이 폴더의 카테고리 설정
    ├── basic.md
    └── advanced.md
```

#### _category_.json 파일 구조

```json
{
  "label": "시작하기",
  "position": 2,
  "link": {
    "type": "generated-index",
    "description": "DSBP JWT 설치/적용 및 초기 환경 설정"
  }
}
```

**주요 속성:**

- `label`: 사이드바에 표시될 카테고리 이름
- `position`: 사이드바에서의 순서 (숫자가 작을수록 위에 표시)
- `link`: 카테고리 클릭 시 표시될 페이지 설정
  - `type`: `"generated-index"` - 자동으로 인덱스 페이지 생성
  - `description`: 카테고리 설명 (인덱스 페이지에 표시됨)

#### 예시

`getstarted/_category_.json`

```json
{
  "label": "시작하기",
  "position": 2,
  "link": {
    "type": "generated-index",
    "description": "DSBP JWT 설치/적용 및 초기 환경 설정"
  }
}
```

## 설정 파일 수정

### docusaurus.config.ts

사이트의 전반적인 설정을 관리하는 파일입니다.

#### 주요 설정 항목

```typescript
const config: Config = {
  title: "My Site", // 사이트 제목
  tagline: "Dinosaurs are cool", // 사이트 태그라인
  favicon: "img/favicon.ico", // 파비콘

  url: "https://your-docusaurus-site.example.com",
  baseUrl: "/main/", // 베이스 URL

  i18n: {
    defaultLocale: "en", // 기본 언어 (ko로 변경 가능)
    locales: ["en"], // 지원 언어
  },

  themeConfig: {
    navbar: {
      title: "My Site", // 네비게이션 바 제목
      items: [
        {
          type: "docSidebar",
          sidebarId: "tutorialSidebar",
          position: "left",
          label: "Tutorial", // 네비게이션 메뉴 이름
        },
      ],
    },
  },
};
```

#### 한국어 설정

```typescript
i18n: {
  defaultLocale: 'ko',
  locales: ['ko'],
},
```

#### 네비게이션 바 커스터마이징

```typescript
navbar: {
  title: 'DSBP',
  items: [
    {
      type: 'docSidebar',
      sidebarId: 'tutorialSidebar',
      position: 'left',
      label: 'Docs',
    }
  ],
},
```

## 문서 작성 워크플로우

### 1. 새 문서 카테고리 만들기

```bash
# main/docs/ 안에 새 폴더 생성
mkdir main/docs/my-category
```

### 2. 카테고리 설정

```bash
# main/docs/my-category/_category_.json 생성
touch main/docs/my-category/_category_.json
```

### 3. 카테고리 작성

```json
{
  "label": "내 문서",
  "position": 1,
  "link": {
    "type": "generated-index",
    "description": "내 문서"
  }
}
```

### 4. 문서 파일 생성

```bash
# 새 마크다운 파일 생성
touch main/docs/my-category/my-document.md
```

### 5. 문서 작성

```markdown
---
sidebar_position: 1
sidebar_label: 내 문서
---

# 내 문서 제목

문서 내용을 작성합니다...
```

### 6. 개발 서버에서 확인

개발 서버가 실행 중이라면 자동으로 변경사항이 반영됩니다.
실행 중이 아니라면:

```bash
cd main
npm run start
```

## 배포

이 프로젝트는 GitLab CI/CD 파이프라인이 구성되어 있어 자동 배포가 가능합니다.

### 배포 프로세스

문서를 수정하고 GitLab에 커밋/푸시하면 자동으로 다음 단계가 실행됩니다:

#### 1단계: 이미지 빌드 (build-image)

- Kaniko를 사용하여 Docker 이미지 빌드
- 빌드된 이미지를 프라이빗 레지스트리(`125.133.65.244:5000`)에 푸시
- 이미지 이름: `dsbp-jwt-main-docs:latest`

#### 2단계: 배포 (deploy)

- SSH를 통해 배포 서버(`125.133.65.245:2222`)에 접속
- `/home/dsbp-jwt-main-docs/startup.sh` 스크립트 실행
- 새로운 Docker 이미지로 컨테이너 재시작

#### 3단계: 알림 (notify)

- 배포 성공/실패 여부를 Mattermost로 알림 전송

### 배포 방법

#### 1. 문서 작성/수정

문서를 작성하거나 수정합니다.

```bash
# 예시: main/docs/intro.md 수정
vim main/docs/intro.md
```

#### 2. Git 커밋 및 푸시

```bash
# 변경사항 확인
git status

# 변경사항 스테이징
git add .

# 커밋 (의미있는 커밋 메시지 작성)
git commit -m "docs: Vue Starter 소개 페이지 작성"

# GitLab에 푸시
git push origin main
```

#### 3. 파이프라인 확인

GitLab 프로젝트 페이지에서 파이프라인 진행 상황을 확인할 수 있습니다:

1. GitLab 프로젝트 페이지 접속
2. 좌측 메뉴에서 **CI/CD > Pipelines** 클릭
3. 최근 파이프라인 상태 확인

#### 4. 배포 결과 확인

- 파이프라인이 성공적으로 완료되면 Mattermost로 알림이 전송됩니다
- 배포된 문서는 자동으로 서버에 반영됩니다

### 주의사항

- main 브랜치에 푸시하면 자동으로 배포됩니다

## 참고 자료

- [Docusaurus 공식 문서](https://docusaurus.io/docs)
- [Markdown 가이드](https://www.markdownguide.org/)
- 프로젝트 내 `dsbp-jwt` 디렉토리
